---
title: "Using R for bioassessment data: What, why, and how"
---

```{r setup, echo=FALSE, warning=FALSE, purl=FALSE, message=FALSE}
options(repos = "http://cran.rstudio.com/")
pkgs <- c("dplyr", "knitr")
x<-lapply(pkgs, library, character.only = TRUE)
opts_chunk$set(tidy = FALSE, message = F, warning = F)
```


## Lesson Outline

- [Goals and Motivation]
- [R/RStudio fundamentals]
- [Getting your data into R]

## Goals and Motivation

[R](https://www.r-project.org/) is a language for statistical computing as well as a general purpose programming language. Increasingly, it has become one of the primary languages used in data science and for data analysis across many of the natural sciences. 

The goals of this training are to expose you to fundamentals and to develop an appreciation of what's possible with this software.  We also provide resources that you can use for follow-up learning on your own. You should be able to answer these questions at the end of this session:

* What is R/RStudio and why should I use it?
* How can I write, save, and run scripts in RStudio?
* How do I import data? 

### Why should I invest time in R?

There are many programming languages available and each has it's specific benefits. R was originally created as a statistical programming language but now it is largely viewed as a 'data science' language.

R is also an open-source programming language - not only is it free, but this means anybody can contribute to it's development. As of `r format(Sys.time(), "%Y-%m-%d")`, there are `r nrow(available.packages())` supplemental packages for R on CRAN! 

## RStudio

In the old days, the only way to use R was directly from the Console - this is a bare bones way of running R only with direct input of commands. Now, [RStudio](https://www.rstudio.com/) is the go-to Interactive Development Environment (IDE) for R. Think of it like a car that is built around an engine. It is integrated with the console (engine) and includes many other features to improve the user's experience. 

Let's get familiar with RStudio before we go on.  

### Open R and RStudio

If you haven't done so already, download and install RStudio from the link above (version 1.3.1073).  After it's installed, find the RStudio shortcut and fire it up.  You should see something like this: 

INSERT figure/rstudio.png HERE LATER

There are four panes in RStudio (starting from the bottom left and moving clockwise): 

* Console
* Source
* Environment, History, etc.
* Files, Plots, etc.

### Executing code in RStudio

The first part of RStudio that we will be working in is called the *Console*. This is the part of the application that tells you what R is running and it performs many of the same commands as you would be able to do in a calculator or in Microsoft Excel.

Type the following text into the console, press `Enter`, and you should see the following results:

`4`

```{r, echo = FALSE}

4

```


`4+8`

```{r, echo = FALSE}

4+8

```

You can also create variables with custom values. In this case the first part of the code is a name of your choosing. Ideally it should have some meaning, but the only rules are that it can't start with a number and must not have any spaces. The second bit, `<-`, is the assignment operator. This tells R to take the result of whatever is on the right side of the `<-` and store it in a new object.

Type the following into your *Console* and press `Enter` after each one to see their output:

`stream <- 4`

```{r, include = FALSE}

stream <- 4

```


`pebble <- 8`

```{r, include = FALSE}

pebble <- 8

```


You might notice is no output in the *Console* for the lines of code you have just run. Instead, they have been stored in your *Environment* in the top right pane of your RStudio window. You can run these variables by typing their name in the *Console* and pressing `Enter`.

There are two possible outcomes when you run code.  First, the code will simply print output directly in the console.  Second, there is no output because you have stored it as a variable in the *Environment*.  The *Environment* is the collection of named objects that are stored in memory for your current R session.  Anything stored in memory will be accessible by it's name without running the original script that was used to create it.  

If you add the variables you just created together, you should see the following:

`stream + pebble`

```{r, echo = FALSE}

stream + pebble

```


You can also create new variables using existing variables like so:

`habitat <- stream + pebble`

```{r, echo = FALSE}

habitat <- stream + pebble

```


Try to call the variable by typing:

`habitatt`

```{r, echo = FALSE}

print("Error: object 'habitatt' not found")

```


This line of code will give you an error, because you must type your variable names exactly as they appear. Please keep in mind that R is also **case-sensitive**.

Try to call the variable once more in the *Console* using the correct spelling:

`habitat`

```{r, echo = FALSE}

habitat

```


**Please note:** Clicking on the broom button in the *Environment* will permanently clear out your existing variables. 

In this same pane in the RStudio window is the *History* tab, which will record all the code you've run, and the *Connections* tab will show connections to other databases, etc.

### Packages

Immediately below the *Environment* is the third section of RStudio, where all of your *Packages* are stored. The base install of R is quite powerful, but you will soon have a need to go beyond this. Packages provide this ability. They are a standardized way of extending R with new methods, techniques, and programming functionality.

### CRAN

One of the reasons for R's popularity is CRAN, [The Comprehensive R Archive Network](http://cran.r-project.org/).  This is where you download R and also where you can gain access to additional packages.  All of the packages we'll be using during this tutorial will be downloaded from CRAN.  As of `r format(Sys.time(), "%Y-%m-%d")`, there are `r nrow(available.packages())` on CRAN! 

### Installing packages

When a package gets installed, that means the source code is downloaded and put into your library. Let's give it a shot using the [tidyverse](https://tidyverse.tidyverse.org/index.html), a set of packages assembled for data tidying and visualization purposes.

Type the following into your *Console* and press `Enter`:

`install.packages("tidyverse")`

You should see it appear in the packages tab. To find it you can either scroll through the list, or type the package name into the search bar at the top of the pane.

In order to use a package, you must attach it to your current workspace. To attach the `tidyverse`, type the following into your *Console* and press `Enter`:

`library(tidyverse)`

Now your package is loaded, and ready to use. You can be certain your package is attached if there is a check mark next to the package name in the *Packages* tab. The remaining tabs in the *Packages* pane allow you to see the *Files* that are associated with your code, the *Plots* you've created, *Help* documents for when you get stuck, and view additional HTML content you might create with the *Viewer* tab.

Great job! You've opened up RStudio, learned about some basic functionalities, and now you're ready to get going on your first R project!

## Scripts

### RStudio projects

I strongly encourage you to use RStudio projects when you are working with R.  The RStudio project provides a central location for working on a particular task.  It helps with file management and is portable because all the files live in the same project.  RStudio projects also remember history - what commands you used and what data objects are in your enviornment.  

To create a new project, click on the File menu at the top and select 'New project...'

INSERT figure/rstudio_proj.jpg HERE LATER

Now we can use this project for our data and any scripts we create.  

### Scripting

In most cases, you will not enter and execute code directly in the console.  Code can be written in a script and then sent directly to the console when you're ready to run it.  The key difference here is that a script can be saved and shared.

Open a new script from the File menu...

INSERT figure/rstudio_script.jpg HERE LATER

### RStudio projects

I strongly encourage you to use RStudio projects when you are working with R.  The RStudio project provides a central location for working on a particular task.  It helps with file management and is portable because all the files live in the same project.  RStudio projects also remember history - what commands you used and what data objects are in your enviornment.  

To create a new project, click on the File menu at the top and select 'New project...'

INSERT figure/rstudio_proj.jpg HERE LATER

Now we can use this project for our data and any scripts we create.  

### Scripting

In most cases, you will not enter and execute code directly in the console.  Code can be written in a script and then sent directly to the console when you're ready to run it.  The key difference here is that a script can be saved and shared.

Open a new script from the File menu...

INSERT figure/rstudio_script.jpg HERE LATER

### Executing code in RStudio

After you write your script it can be sent to the Console to run the code in R.  Any variables you create in your script will not be available in your working environment until this is done.  There are two ways to send code to the console.  First, you can hit the `Run` button at the top right of the scripting window.  Second, and preferred, you can use `ctrl+enter` (`cmd+enter` on a Mac).  Both approaches will send the selected line to the console, then move to the next line in your script.  You can also highlight and send an entire block of code.

INSERT figure/rstudio_run.jpg HERE LATER

## Additional R Resources

### Getting Help

Being able to find help and interpret that help is probably one of the most important skills for learning a new language.  R is no different. Help on functions and packages can be accessed directly from R, can be found on CRAN and other official R resources, searched on Google, found on StackOverflow, or from any number of fantastic online resources.

### Help from the console

Getting help from the console is straightforward and can be done numerous ways.

```{r help_from_console, eval=FALSE}
# Using the help command/shortcut
# When you know the name of a function
help("print") # Help on the print command
?print # Help on the print command using the `?` shortcut

# When you know the name of the package
help(package = "dplyr") # Help on the package `dplyr`

# Don't know the exact name or just part of it
apropos("print") # Returns all available functions with "print" in the name
??print # shortcut, but also searches demos and vignettes in a formatted page
```

### Official R Resources

In addition to help from within R itself, CRAN and the R-Project have many resources available for support.  Two of the most notable are the mailing lists and the [task views](http://cran.r-project.org/web/views/).

- [R Help Mailing List](https://stat.ethz.ch/mailman/listinfo/r-help): The main mailing list for R help.
- [R-sig-ecology](https://stat.ethz.ch/mailman/listinfo/r-sig-ecology): A special interest group for use of R in ecology. Less daunting than the main help with participation from some big names in ecological modelling and statistics.
- [Environmetrics Task View](http://cran.r-project.org/web/views/Environmetrics.html): Task views are great in that they provide an annotated list of packages relevant to a particular field. This one is maintained by Gavin Simpson and has great info on packages relevant to much of the work at EPA.
- [Spatial Analysis Task View](http://cran.r-project.org/web/views/Spatial.html): One that lists all the relevant packages for spatial analysis, GIS, and Remote Sensing in R. 

There are also a number of platforms created to support communities using R such as [RLadies](https://rladies.org/) and [RStudioEDU](https://twitter.com/RStudioEDU).

### Google and StackOverflow

While the resources already mentioned are useful, often the quickest way is to just turn to Google. Google works great if you search for a given package or function name. You can also type in the error you are experiencing verbatim - chances are, someone before you has encountered the *exact* same problem.

Blind googling can require a bit of strategy to get the info you want.  Some pointers:

* Always preface the search with "r"
* Understand which sources are reliable
* Take note of the number of hits and date of a web page
* When in doubt, search with the exact error message (see here for [details](https://cran.r-project.org/doc/manuals/R-lang.html#Exception-handling) about warnings vs errors)

One specific resource that I use quite a bit is [StackOverflow with the 'r' tag](http://stackoverflow.com/questions/tagged/r).  StackOverflow is a discussion forum for all things related to programming.  You can then use this tag and the search functions in StackOverflow and find answers to almost anything you can think of. However, these forums are also very strict and I typically use them to find answers not to ask questions.  

### Other Resources

Below are just a few more resources I like:

- [R For Cats](http://rforcats.net/): Basic introduction site, meant to be a gentle and light-hearted introduction
- [R For Data Science](https://r4ds.had.co.nz/): Web home of Hadley Wickham and Garret Grolemund's introduction to R textbook.
- [Advanced R](http://adv-r.had.co.nz/): Web home of Hadley Wickham's new book.  Gets into more advanced topics, but also covers the basics in a great way.
- [Stat 545](https://stat545.com/): Course materials for Jenny Bryan's introduction to data science course developed at the University of British Columbia.
- [Stats the Way I Like It](https://statsthewayilikeit.com/): Course materials for Allison Horst's introduction to environmental data science course developed at the University of California Santa Barbara.
- [CRAN Cheatsheets](http://cran.r-project.org/doc/contrib/Short-refcard.pdf): A good cheat sheet from the official source
- [RStudio Cheatsheets](http://www.rstudio.com/resources/cheatsheets/): Additional cheat sheets from RStudio.  I am especially fond of the data wrangling one.
